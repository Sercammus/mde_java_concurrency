<?xml version="1.0" encoding="UTF-8"?>
<ad:BasicModel
    xmi:version="2.0"
    xmlns:xmi="http://www.omg.org/XMI"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:ad="www.example.org/basicModel"
    xsi:schemaLocation="www.example.org/basicModel /basic2enriched/metamodels/BasicModel.ecore"
    name="chatServer"
    startActivity="//@activities.0">
  <activities
      xsi:type="ad:Fork"
      name="fork1">
    <forkedThreads
        name="guiThread"
        startActivity="//@activities.0/@forkedThreads.0/@activities.0">
      <activities
          xsi:type="ad:SimpleActivity"
          name="getUserInput"
          instance="//@instances.0"
          nextActivity="//@activities.0/@forkedThreads.0/@activities.1"
          activityName="getUserInput"/>
      <activities
          xsi:type="ad:Decision"
          name="checkUserInput"
          instance="//@instances.0"
          nextActivity="//@activities.0/@forkedThreads.0/@activities.3">
        <branches
            nextActivity="//@activities.0/@forkedThreads.0/@activities.2"
            condition="[message]"/>
      </activities>
      <activities
          xsi:type="ad:SimpleActivity"
          name="broadcastMsg"
          instance="//@instances.0"
          nextActivity="//@activities.0/@forkedThreads.0/@activities.0"
          activityName="broadcastMsg"/>
      <activities
          xsi:type="ad:Interrupt"
          name="interrupt"
          instance="//@instances.0"
          nextActivity="//@activities.0/@forkedThreads.0/@activities.4"
          interruptedThread="//@activities.0/@forkedThreads.1"/>
      <activities
          xsi:type="ad:End"
          name="end1"
          instance="//@instances.0"/>
    </forkedThreads>
    <forkedThreads
        name="serverThread"
        startActivity="//@activities.0/@forkedThreads.1/@activities.0">
      <activities
          xsi:type="ad:SimpleActivity"
          name="listenForClient"
          instance="//@instances.2"
          nextActivity="//@activities.0/@forkedThreads.1/@activities.1"
          activityName="listenForClient"/>
      <activities
          xsi:type="ad:SimpleActivity"
          name="addClient"
          instance="//@instances.2"
          nextActivity="//@activities.0/@forkedThreads.1/@activities.2"
          activityName="addClient"
          sharedResources="//@resources.0"/>
      <activities
          xsi:type="ad:Fork"
          name="fork2"
          instance="//@instances.2">
        <forkedThreads
            name="goBackThread"
            startActivity="//@activities.0/@forkedThreads.1/@activities.0"/>
        <forkedThreads
            name="clientThread"
            startActivity="//@activities.0/@forkedThreads.1/@activities.2/@forkedThreads.1/@activities.0">
          <activities
              xsi:type="ad:Decision"
              name="checkForEvent"
              instance="//@instances.1"
              nextActivity="//@activities.0/@forkedThreads.1/@activities.2/@forkedThreads.1/@activities.2">
            <branches
                nextActivity="//@activities.0/@forkedThreads.1/@activities.2/@forkedThreads.1/@activities.1"
                condition="[no msg]"/>
            <branches
                nextActivity="//@activities.0/@forkedThreads.1/@activities.2/@forkedThreads.1/@activities.3"
                condition="[disconnect]"/>
          </activities>
          <activities
              xsi:type="ad:Sleep"
              name="sleep"
              instance="//@instances.1"
              nextActivity="//@activities.0/@forkedThreads.1/@activities.2/@forkedThreads.1/@activities.0"
              duration="1"/>
          <activities
              xsi:type="ad:SimpleActivity"
              name="displayMsg"
              instance="//@instances.1"
              nextActivity="//@activities.0/@forkedThreads.1/@activities.2/@forkedThreads.1/@activities.1"
              activityName="displayMsg"/>
          <activities
              xsi:type="ad:SimpleActivity"
              name="removeClient"
              instance="//@instances.1"
              nextActivity="//@activities.0/@forkedThreads.1/@activities.2/@forkedThreads.1/@activities.4"
              activityName="removeClient"
              sharedResources="//@resources.0"/>
          <activities
              xsi:type="ad:End"
              name="end2"
              instance="//@instances.1"/>
        </forkedThreads>
      </activities>
    </forkedThreads>
  </activities>
  <resources
      name="clientList"/>
  <instances
      name="gui"
      instanceType="//@instanceTypes.0"/>
  <instances
      name="c"
      instanceType="//@instanceTypes.2"/>
  <instances
      name="s"
      instanceType="//@instanceTypes.1"/>
  <instanceTypes
      name="GUI"/>
  <instanceTypes
      name="Server"/>
  <instanceTypes
      name="Client"/>
</ad:BasicModel>
