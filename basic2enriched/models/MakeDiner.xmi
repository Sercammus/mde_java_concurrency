<?xml version="1.0" encoding="UTF-8"?>
<ad:BasicModel
    xmi:version="2.0"
    xmlns:xmi="http://www.omg.org/XMI"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:ad="www.example.org/basicModel"
    xsi:schemaLocation="www.example.org/basicModel /basic2enriched/metamodels/BasicModel.ecore"
    name="makeDinerThread"
    startActivity="//@activities.0">
  <activities
      xsi:type="ad:Fork"
      name="fork1">
    <forkedThreads
        name="riceThread"
        startActivity="//@activities.0/@forkedThreads.0/@activities.0">
      <activities
          xsi:type="ad:SimpleActivity"
          name="cookWater"
          nextActivity="//@activities.0/@forkedThreads.0/@activities.1"
          activityName="cookWater"/>
      <activities
          xsi:type="ad:Sleep"
          name="sleep1"
          nextActivity="//@activities.0/@forkedThreads.0/@activities.2"
          duration="600"/>
      <activities
          xsi:type="ad:SimpleActivity"
          name="putRiceInWater"
          nextActivity="//@activities.0/@forkedThreads.0/@activities.3"
          activityName="putRiceInWater"/>
      <activities
          xsi:type="ad:Sleep"
          name="sleep2"
          nextActivity="//@activities.0/@forkedThreads.0/@activities.4"
          duration="600"/>
      <activities
          xsi:type="ad:SimpleActivity"
          name="takeRiceFromWater"
          nextActivity="//@activities.0/@forkedThreads.0/@activities.5"
          activityName="takeRiceFromWater"/>
      <activities
          xsi:type="ad:Join"
          name="join1"
          nextActivity="//@activities.1"/>
    </forkedThreads>
    <forkedThreads
        name="cookThread"
        startActivity="//@activities.0/@forkedThreads.1/@activities.0">
      <activities
          xsi:type="ad:Fork"
          name="fork3">
        <forkedThreads
            name="vegetablesThread"
            startActivity="//@activities.0/@forkedThreads.1/@activities.0/@forkedThreads.0/@activities.0">
          <activities
              xsi:type="ad:SimpleActivity"
              name="cutVegetables"
              nextActivity="//@activities.0/@forkedThreads.1/@activities.0/@forkedThreads.0/@activities.1"
              activityName="cutVegetables"/>
          <activities
              xsi:type="ad:Join"
              name="join3"
              nextActivity="//@activities.0/@forkedThreads.1/@activities.1"/>
        </forkedThreads>
        <forkedThreads
            name="meatThread"
            startActivity="//@activities.0/@forkedThreads.1/@activities.0/@forkedThreads.1/@activities.0">
          <activities
              xsi:type="ad:NestedActivity"
              name="prepareMeat"
              nextActivity="//@activities.0/@forkedThreads.1/@activities.0/@forkedThreads.0/@activities.1"
              nestedThread="//@nestedThreads.0"/>
        </forkedThreads>
      </activities>
      <activities
          xsi:type="ad:SimpleActivity"
          name="addVegetablesToMeat"
          nextActivity="//@activities.0/@forkedThreads.1/@activities.2"
          activityName="addVegetablesToMeat"/>
      <activities
          xsi:type="ad:Yield"
          name="yield1"
          nextActivity="//@activities.0/@forkedThreads.1/@activities.3"/>
      <activities
          xsi:type="ad:Decision"
          name="areVegetablesDone"
          nextActivity="//@activities.0/@forkedThreads.1/@activities.2">
        <branches
            nextActivity="//@activities.0/@forkedThreads.0/@activities.5"
            condition="[vegetables are done]"/>
      </activities>
    </forkedThreads>
    <forkedThreads
        name="makeTableThread"
        startActivity="//@activities.0/@forkedThreads.2/@activities.0">
      <activities
          xsi:type="ad:SimpleActivity"
          name="makeTable"
          nextActivity="//@activities.0/@forkedThreads.2/@activities.1"
          activityName="makeTable"/>
      <activities
          xsi:type="ad:End"
          name="end2"/>
    </forkedThreads>
  </activities>
  <activities
      xsi:type="ad:Fork"
      name="fork2">
    <forkedThreads
        name="addHerbsThread"
        startActivity="//@activities.1/@forkedThreads.0/@activities.0">
      <activities
          xsi:type="ad:SimpleActivity"
          name="addHerbs"
          nextActivity="//@activities.1/@forkedThreads.1/@activities.1"
          activityName="addHerbs"/>
    </forkedThreads>
    <forkedThreads
        name="addRiceThread"
        startActivity="//@activities.1/@forkedThreads.1/@activities.0">
      <activities
          xsi:type="ad:SimpleActivity"
          name="addRice"
          nextActivity="//@activities.1/@forkedThreads.1/@activities.1"
          activityName="addRice"/>
      <activities
          xsi:type="ad:Join"
          name="join2"
          nextActivity="//@activities.1/@forkedThreads.1/@activities.2"/>
      <activities
          xsi:type="ad:SimpleActivity"
          name="mix"
          nextActivity="//@activities.1/@forkedThreads.1/@activities.3"
          activityName="mix"/>
      <activities
          xsi:type="ad:End"
          name="end1"/>
    </forkedThreads>
  </activities>
  <nestedThreads
      name="prepareMeatThread"
      startActivity="//@nestedThreads.0/@activities.0"
      activityName="prepareMeat">
    <activities
        xsi:type="ad:SimpleActivity"
        name="putMeatInPan"
        nextActivity="//@nestedThreads.0/@activities.1"
        activityName="putMeatInPan"/>
    <activities
        xsi:type="ad:Fork"
        name="fork4">
      <forkedThreads
          name="turnMeatThread"
          startActivity="//@nestedThreads.0/@activities.1/@forkedThreads.0/@activities.0">
        <activities
            xsi:type="ad:Sleep"
            name="sleep3"
            nextActivity="//@nestedThreads.0/@activities.1/@forkedThreads.0/@activities.1"
            duration="10"/>
        <activities
            xsi:type="ad:SimpleActivity"
            name="turnMeat"
            nextActivity="//@nestedThreads.0/@activities.1/@forkedThreads.0/@activities.0"
            activityName="turnMeat"/>
      </forkedThreads>
      <forkedThreads
          name="waitForMeatThread"
          startActivity="//@nestedThreads.0/@activities.1/@forkedThreads.1/@activities.0">
        <activities
            xsi:type="ad:Yield"
            name="yield2"
            nextActivity="//@nestedThreads.0/@activities.1/@forkedThreads.1/@activities.1"/>
        <activities
            xsi:type="ad:Decision"
            name="isMeatDone"
            nextActivity="//@nestedThreads.0/@activities.1/@forkedThreads.1/@activities.0">
          <branches
              nextActivity="//@nestedThreads.0/@activities.1/@forkedThreads.1/@activities.2"
              condition="[meat is done]"/>
        </activities>
        <activities
            xsi:type="ad:Interrupt"
            name="interrupt1"
            nextActivity="//@nestedThreads.0/@activities.1/@forkedThreads.1/@activities.3"
            interruptedThread="//@nestedThreads.0/@activities.1/@forkedThreads.0"/>
        <activities
            xsi:type="ad:End"
            name="end3"/>
      </forkedThreads>
    </activities>
  </nestedThreads>
</ad:BasicModel>
